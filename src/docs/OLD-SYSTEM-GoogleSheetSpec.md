# ЁЯУК Sheet Specification: CPE Funds Tracker (Class 30) Dashboard

р╣Ар╕нр╕Бр╕кр╕▓р╕гр╕Щр╕╡р╣Йр╕гр╕░р╕Ър╕╕р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕нр╕З Sheet р╕Кр╕╖р╣Ир╕н **"Dashboard"** р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕Кр╣Йр╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕Щр╣Бр╕Ър╕Ър╣Гр╕Щр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕Зр╕гр╕░р╕Ър╕Ър╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щр╕кр╕▓р╕Вр╕▓ р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕г Migration р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╣Гр╕лр╕бр╣И

## 1. р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Бр╕Цр╕зр╣Бр╕ер╕░р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М (Grid Layout)

### р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╕Хр╕▓р╕гр╕▓р╕З (Header Sections)

- **р╣Бр╕Цр╕зр╕Чр╕╡р╣И 1-3:** р╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕кр╕│р╕лр╕гр╕▒р╕Ър╕Кр╕╖р╣Ир╕нр╕гр╕░р╕Ър╕Ър╣Бр╕ер╕░р╕кр╕гр╕╕р╕Ыр╕вр╕нр╕Фр╕гр╕зр╕б (р╣Ар╕Кр╣Ир╕Щ "р╕кр╕гр╕╕р╕Ыр╕Бр╕▓р╕гр╣Ар╕Бр╣Зр╕Ър╣Ар╕Зр╕┤р╕Щр╕Ыр╕╡ 68", "р╕вр╕нр╕Фр╕гр╕зр╕бр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф", "р╕Ир╕│р╕Щр╕зр╕Щр╕Др╕Щр╕Ир╣Ир╕▓р╕вр╣Бр╕ер╣Йр╕з")
- **р╣Бр╕Цр╕зр╕Чр╕╡р╣И 4:** р╣Бр╕Цр╕Ър╕зр╣Ир╕▓р╕Зр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕▒р╣Ир╕Щр╕лр╕▒р╕зр╕Хр╕▓р╕гр╕▓р╕З
- **р╣Бр╕Цр╕зр╕Чр╕╡р╣И 5 (Header Row):** р╕Бр╕│р╕лр╕Щр╕Фр╕лр╕▒р╕зр╕Вр╣Йр╕нр╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╕кр╕│р╕Др╕▒р╕Н
  - **р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М A:** р╕ер╕│р╕Фр╕▒р╕Ъ (No.)
  - **р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М B:** р╕Др╕│р╕Щр╕│р╕лр╕Щр╣Йр╕▓
  - **р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М C:** р╕Кр╕╖р╣Ир╕н-р╕Щр╕▓р╕бр╕кр╕Бр╕╕р╕е
  - **р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М D:** р╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Х (Primary Key р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕Кр╕╖р╣Ир╕нр╕бр╣Вр╕вр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е)
  - **р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М E р╕Цр╕╢р╕З P:** р╕Кр╕╖р╣Ир╕нр╣Ар╕Фр╕╖р╕нр╕Щр╕Чр╕╡р╣Ир╕Ир╣Ир╕▓р╕в (р╣Ар╕Кр╣Ир╕Щ р╕Бр╕гр╕Бр╕Ор╕▓р╕Др╕б, р╕кр╕┤р╕Зр╕лр╕▓р╕Др╕б, ...) р╣Вр╕Фр╕вр╣Гр╕Щр╣Бр╕Цр╕зр╕Чр╕╡р╣И 5 р╕Хр╣Йр╕нр╕Зр╕Юр╕┤р╕бр╕Юр╣Мр╕Кр╕╖р╣Ир╕нр╣Ар╕Фр╕╖р╕нр╕Щр╣Гр╕лр╣Йр╕Хр╕гр╕Зр╕Бр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щ Sheet `Records`
  - **р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М Q:** р╕вр╕нр╕Фр╕гр╕зр╕бр╕Ир╣Ир╕▓р╕вр╣Бр╕ер╣Йр╕з (Total Paid)
  - **р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М R:** р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕ / р╕кр╕Цр╕▓р╕Щр╕░р╕лр╕Щр╕╡р╣Йр╕кр╕┤р╕Щ (Remark)

## 2. р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щр╣Бр╕Хр╣Ир╕ер╕░р╣Ар╕Лр╕ер╕ер╣М (Cell Definitions)

### р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕Зр╕Чр╕╡р╣И (Static Data)

- **р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М A5 - Dxx:** р╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╕Щр╕┤р╕кр╕┤р╕Хр╣Бр╕ер╕░р╕гр╕лр╕▒р╕кр╕Ыр╕гр╕░р╕Ир╕│р╕Хр╕▒р╕з (р╕Др╕зр╕гр╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Ыр╕гр╕░р╕бр╕▓р╕У 10-20 р╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕н)

### р╕кр╣Ир╕зр╕Щр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕е (Dynamic Calculation)

- **р╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ (р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М E6 р╕Цр╕╢р╕З Pxx):**

  - **р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И:** р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕вр╕нр╕Фр╣Вр╕нр╕Щр╕Ир╕▓р╕Б Sheet `Records`
  - **р╕кр╕╣р╕Хр╕гр╕Чр╕╡р╣Ир╣Гр╕Кр╣Й:** `=IFERROR(FILTER(Records!$C:$C, Records!$B:$B = $D6, Records!$E:$E = 68, Records!$F:$F = E$5), "0")`
  - **р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в:** р╕лр╕▓р╕Бр╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Хр╣Гр╕Щр╕Др╕нр╕ер╕▒р╕бр╕Щр╣М D р╣Бр╕ер╕░р╣Ар╕Фр╕╖р╕нр╕Щр╣Гр╕Щр╣Бр╕Цр╕зр╕Чр╕╡р╣И 5 р╕Хр╕гр╕Зр╕Бр╕▒р╕Ър╣Гр╕Щр╕Ър╕▒р╕Щр╕Чр╕╢р╕Б р╣Гр╕лр╣Йр╣Бр╕кр╕Фр╕Зр╕вр╕нр╕Фр╣Ар╕Зр╕┤р╕Щ р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╣Ар╕Ир╕нр╣Гр╕лр╣Йр╣Бр╕кр╕Фр╕З "0"

- **р╕кр╣Ир╕зр╕Щр╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕ (р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М R6 р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕Щр╣Др╕Ы):**
  - **р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И:** р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Бр╕ер╕░р╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╕вр╕нр╕Фр╕Др╣Йр╕▓р╕Зр╕Кр╕│р╕гр╕░
  - **р╕кр╕╣р╕Хр╕гр╕Чр╕╡р╣Ир╣Гр╕Кр╣Й:** `=IF(COUNTIF(E6:P6, 0) = 0, "", "р╕Др╣Йр╕▓р╕Зр╕Ир╣Ир╕▓р╕в " & COUNTIF(E6:P6, 0) & " р╣Ар╕Фр╕╖р╕нр╕Щ, р╕Хр╣Йр╕нр╕Зр╕Ир╣Ир╕▓р╕в " & (COUNTIF(E6:P6, 0) * 80 - 10) & " р╕Ър╕▓р╕Ч")`
  - **Logic:** р╕Цр╣Йр╕▓р╕Щр╕▒р╕Ър╣Ар╕Ир╕нр╣Ар╕ер╕В "0" (р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕Ир╣Ир╕▓р╕в) р╕гр╕░р╕Ър╕Ър╕Ир╕░р╕Др╕│р╕Щр╕зр╕Ур╕Др╣Ир╕▓р╕Ыр╕гр╕▒р╕Ъ (р╣Ар╕Фр╕╖р╕нр╕Щр╕ер╕░ 80 р╕Ър╕▓р╕Ч р╕лр╕▒р╕Бр╕кр╣Ир╕зр╕Щр╕ер╕Фр╣Ар╕Фр╕╖р╕нр╕Щр╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ 10 р╕Ър╕▓р╕Ч)

## 3. р╕Бр╕▓р╕гр╕Бр╕│р╕лр╕Щр╕Фр╕кр╕╡р╣Бр╕ер╕░р╕кр╕Цр╕▓р╕Щр╕░ (Conditional Formatting)

р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Гр╕Щр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Ар╕Ыр╣Кр╕░р╣Ж р╕Хр╣Йр╕нр╕Зр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕кр╕╡р╕Фр╕▒р╕Зр╕Щр╕╡р╣Й:

1. **р╕кр╕Цр╕▓р╕Щр╕░р╕Ир╣Ир╕▓р╕вр╣Бр╕ер╣Йр╕з (р╕кр╕╡р╣Ар╕Вр╕╡р╕вр╕з):**

   - р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕В: Cell Value `Greater than 0`
   - р╕кр╕╡: р╕Юр╕╖р╣Йр╕Щр╕лр╕ер╕▒р╕Зр╕кр╕╡р╣Ар╕Вр╕╡р╕вр╕зр╕нр╣Ир╕нр╕Щ (Light Green), р╕Хр╕▒р╕зр╕нр╕▒р╕Бр╕йр╕гр╕кр╕╡р╣Ар╕Вр╕╡р╕вр╕зр╣Ар╕Вр╣Йр╕б

2. **р╕кр╕Цр╕▓р╕Щр╕░р╕Др╣Йр╕▓р╕Зр╕Ир╣Ир╕▓р╕в (р╕кр╕╡р╣Бр╕Фр╕З/р╣Ар╕ер╕В 0):**

   - р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕В: Cell Value `Is equal to 0`
   - р╕кр╕╡: р╕Хр╕▒р╕зр╕нр╕▒р╕Бр╕йр╕гр╕кр╕╡р╣Бр╕Фр╕Зр╣Ар╕Вр╣Йр╕б р╕лр╕гр╕╖р╕нр╕Юр╕╖р╣Йр╕Щр╕лр╕ер╕▒р╕Зр╕кр╕╡р╣Бр╕Фр╕Зр╕нр╣Ир╕нр╕Щ

3. **р╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕зр╣Ир╕▓р╕З (р╣Др╕бр╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕е):**
   - р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕В: `Is empty`
   - р╕кр╕╡: р╕кр╕╡р╕Юр╕╖р╣Йр╕Щр╕лр╕ер╕▒р╕Зр╕Ыр╕Бр╕Хр╕┤ (р╕кр╕╡р╕Вр╕▓р╕зр╕лр╕гр╕╖р╕нр╣Ар╕Чр╕▓р╕нр╣Ир╕нр╕Щ) р╕лр╕бр╕▓р╕вр╕Цр╕╢р╕Зр╣Бр╕нр╕Фр╕бр╕┤р╕Щр╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕ер╕▓р╕Бр╕кр╕╣р╕Хр╕гр╕бр╕▓р╕Цр╕╢р╕Зр╣Ар╕Фр╕╖р╕нр╕Щр╕Щр╕▒р╣Йр╕Щ

## 4. р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕З Sheet "Records" (Data Source)

_р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Й AI р╕кр╕гр╣Йр╕▓р╕Зр╕гр╕░р╕Ър╕Ър╣Др╕Фр╣Йр╕кр╕бр╕Ър╕╣р╕гр╕Ур╣М р╕Хр╣Йр╕нр╕Зр╕бр╕╡ Sheet `Records` р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Фр╣Йр╕зр╕вр╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╕Фр╕▒р╕Зр╕Щр╕╡р╣Й:_

- **Column A:** Timestamp
- **Column B:** Student ID
- **Column C:** Amount
- **Column D:** Slip Link
- **Column E:** Year (68)
- **Column F:** Month
- **Column G:** Email
- **Column H:** Remark

---

**р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕:** р╣Ар╕нр╕Бр╕кр╕▓р╕гр╕Щр╕╡р╣Йр╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ър╕нр╣Йр╕▓р╕Зр╕нр╕┤р╕Зр╣Гр╕Щр╕Бр╕▓р╕гр╕Юр╕▒р╕Тр╕Щр╕▓р╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╣Гр╕Щ `src/app/(admin)/admin/payments` р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Щр╕│р╣Ар╕Вр╣Йр╕▓р╣Бр╕ер╕░р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Чр╕╡р╣Ир╕Др╕╕р╣Йр╕Щр╣Ар╕Др╕вр╕Ир╕▓р╕Бр╕гр╕░р╕Ър╕Ър╣Ар╕Фр╕┤р╕б
